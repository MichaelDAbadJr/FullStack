import{r as m,A as j,j as e,R as f,a as w}from"./index-CeC7V2yR.js";import{C as N}from"./Card-D0ap9KdA.js";import{u as T,I as n,V as L,b as E,a as y}from"./form-hook-CTeF-nu7.js";import{u as A,E as P,B as u}from"./http-hook-sUJLLvpC.js";import{I as S}from"./ImageUpload-BQ_eeKOH.js";const b=()=>{const o=m.useContext(j),[t,c]=m.useState(!0),{isLoading:h,error:x,sendRequest:l,clearError:g}=A(),[a,i,p]=T({email:{value:"",isValid:!1},password:{value:"",isValid:!1}},!1),v=()=>{t?p({...a.inputs,name:{value:"",isValid:!1},image:{value:null,isValid:!1}},!1):p({...a.inputs,name:void 0,image:void 0},a.inputs.email.isValid&&a.inputs.password.isValid),c(r=>!r)},I=async r=>{if(r.preventDefault(),t)try{const s=await l("https://mern-picture-app.uc.r.appspot.com/api/users/login","POST",JSON.stringify({email:a.inputs.email.value,password:a.inputs.password.value}),{"Content-Type":"application/json"});o.login(s.userId,s.token)}catch(s){console.log(s)}else try{const s=new FormData;s.append("email",a.inputs.email.value),s.append("name",a.inputs.name.value),s.append("password",a.inputs.password.value),s.append("image",a.inputs.image.value),console.log(a.inputs.image.value);const d=await l("https://mern-picture-app.uc.r.appspot.com/api/users/signup","POST",s);o.login(d.userId,d.token)}catch(s){console.log(s)}};return e.jsxs(f.Fragment,{children:[e.jsx(P,{error:x,onClear:g}),e.jsxs(N,{className:"authentication",children:[h&&e.jsx(w,{asOverlay:!0}),e.jsx("h2",{children:"Login Required"}),e.jsx("hr",{}),e.jsxs("form",{onSubmit:I,children:[!t&&e.jsx(n,{element:"input",id:"name",type:"text",label:"Your Name",validators:[L()],errorText:"Please enter a name.",onInput:i}),!t&&e.jsx(S,{center:!0,id:"image",onInput:i,errorText:"Please provide an image."}),e.jsx(n,{element:"input",id:"email",type:"email",label:"E-mail",validators:[E()],errorText:"Please enter a valid email address",onInput:i}),e.jsx(n,{element:"input",id:"password",type:"password",label:"Password",validators:[y(6)],errorText:"Please enter a valid password, at least 6 characters.",onInput:i}),e.jsx(u,{type:"submit",disabled:!a.isValid,children:t?"LOGIN":"SIGNUP"})]}),e.jsxs(u,{inverse:!0,onClick:v,children:["SWITCH TO ",t?"SIGNUP":"LOGIN"]}),e.jsxs("div",{className:"demo-login",children:[e.jsx("h3",{className:"demo",children:"Login with demo Email & Password"}),e.jsx("h4",{className:"demo",children:"Email: test1@test.com"}),e.jsx("h4",{className:"demo",children:"Password: HelloWorld23"}),e.jsx("h4",{className:"demo-note",children:"This will log you in as Alex"})]})]})]})};export{b as default};
