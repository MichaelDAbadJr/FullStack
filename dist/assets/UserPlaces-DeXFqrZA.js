import{r as c,j as e,A as N,R as x,a as C,b as _}from"./index-CeC7V2yR.js";import{C as E}from"./Card-D0ap9KdA.js";import{u as g,E as w,M as p,B as r}from"./http-hook-sUJLLvpC.js";const P=s=>{const a=c.useRef(),{center:t,zoom:l}=s;return c.useEffect(()=>{const o=new window.google.maps.Map(a.current,{center:t,zoom:l});new window.google.maps.Marker({position:t,map:o})},[t,l]),e.jsx("div",{ref:a,className:`map ${s.className}`,style:s.style})},v=s=>{const{isLoading:a,error:t,sendRequest:l,clearError:o}=g(),i=c.useContext(N),[d,m]=c.useState(!1),[h,n]=c.useState(!1),u=()=>m(!0),j=()=>m(!1),D=()=>{n(!0)},f=()=>{n(!1)},M=async()=>{n(!1);try{await l(`https://mern-picture-app.uc.r.appspot.com/api/places/${s.id}`,"DELETE",null,{Authorization:"Bearer "+i.token}),s.onDelete(s.id)}catch{}};return e.jsxs(x.Fragment,{children:[e.jsx(w,{error:t,onClear:o}),e.jsx(p,{show:d,onCancel:j,header:s.address,contentClass:"place-item__modal-content",footerClass:"place-item__modal-actions",footer:e.jsx(r,{onClick:j,children:"CLOSE"}),children:e.jsx("div",{className:"map-container",children:e.jsx(P,{center:s.coordinates,zoom:16})})}),e.jsx(p,{show:h,onCancel:f,header:"Are you sure?",footerClass:"place-item__modal-actions",footer:e.jsxs(x.Fragment,{children:[e.jsx(r,{inverse:!0,onClick:f,children:"CANCEL"}),e.jsx(r,{danger:!0,onClick:M,children:"DELETE"})]}),children:e.jsx("p",{children:"Do you want to proceed and delete this place? Please note that it can't be undone thereafter"})}),e.jsx("li",{className:"place-item",children:e.jsxs(E,{className:"place-item__content",children:[a&&e.jsx(C,{asOverlay:!0}),e.jsx("div",{className:"place-item__image",children:e.jsx("img",{src:`${s.image}`,alt:s.title})}),e.jsxs("div",{className:"place-item__info",children:[e.jsx("h2",{children:s.title}),e.jsx("h3",{children:s.address}),e.jsx("p",{children:s.description})]}),e.jsxs("div",{className:"place-item__actions",children:[e.jsx(r,{inverse:!0,onClick:u,children:"VIEW ON MAP"}),i.userId===s.creatorId&&e.jsx(r,{to:`/places/${s.id}`,children:"EDIT"}),i.userId===s.creatorId&&e.jsx(r,{danger:!0,onClick:D,children:"DELETE"})]})]})})]})},y=s=>s.items.length===0?e.jsx("div",{className:"place-list center",children:e.jsxs(E,{children:[e.jsx("h2",{children:"No places found. Maybe create one?"}),e.jsx(r,{to:"/places/new",children:"Share Place"})]})}):e.jsx("ul",{className:"place-list",children:s.items.map(a=>e.jsx(v,{id:a.id,image:a.image,title:a.title,description:a.description,address:a.address,creatorId:a.creator,coordinates:a.location,onDelete:s.onDeletePlace},a.id))}),H=()=>{const[s,a]=c.useState(),{isLoading:t,error:l,sendRequest:o,clearError:i}=g(),d=_().userId;c.useEffect(()=>{(async()=>{try{const n=await o(`https://mern-picture-app.uc.r.appspot.com/api/places/user/${d}`);a(n.places)}catch{}})()},[o,d]);const m=h=>{a(n=>n.filter(u=>u.id!==h))};return e.jsxs(x.Fragment,{children:[e.jsx(w,{error:l,onClear:i}),t&&e.jsx("div",{className:"center",children:e.jsx(C,{asOverlay:!0})}),!t&&s&&e.jsx(y,{items:s,onDeletePlace:m})]})};export{H as default};
